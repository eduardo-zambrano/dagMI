% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap.R
\name{constrained_bootstrap}
\alias{constrained_bootstrap}
\title{Constrained Bootstrap for DAG Testing}
\usage{
constrained_bootstrap(
  data,
  dag,
  B = 500,
  h = "squared",
  h_params = list(),
  ordering = NULL,
  parallel = FALSE,
  verbose = TRUE,
  seed = NULL
)
}
\arguments{
\item{data}{Numeric matrix with n observations and p variables}

\item{dag}{A dag object specifying the DAG structure}

\item{B}{Number of bootstrap replicates (default 500)}

\item{h}{Test function (default "squared")}

\item{h_params}{Parameters for test function}

\item{ordering}{Optional topological ordering}

\item{parallel}{Logical or number of cores for parallel processing}

\item{verbose}{Logical; show progress (default TRUE)}

\item{seed}{Random seed for reproducibility}
}
\value{
An object of class "bootstrap_result" with components:
\item{t0}{Observed test statistic}
\item{t_boot}{Vector of bootstrap test statistics}
\item{p_value}{Bootstrap p-value}
\item{B}{Number of bootstrap replicates}
\item{qn}{Q_n^G value}
\item{se_boot}{Bootstrap standard error}
\item{ci_lower}{Lower confidence bound (2.5\%)}
\item{ci_upper}{Upper confidence bound (97.5\%)}
}
\description{
Generates bootstrap samples under the null hypothesis that the data
is consistent with the specified DAG structure, and computes the
bootstrap distribution of the test statistic.
}
\details{
The constrained bootstrap generates samples that respect the DAG
structure under H_0. For each bootstrap replicate:
\enumerate{
\item Sample X_1 from the marginal distribution
\item For j = 2, ..., n: sample X_j from p(X_j | pa(X_j))
}

The p-value is the proportion of bootstrap statistics at least as
extreme as the observed statistic.
}
\examples{
A <- matrix(c(0, 1, 0, 0, 0, 1, 0, 0, 0), 3, 3, byrow = TRUE)
g <- dag(A, nodes = c("X1", "X2", "X3"))

set.seed(123)
X1 <- rnorm(100)
X2 <- 0.5 * X1 + rnorm(100, sd = 0.5)
X3 <- 0.5 * X2 + rnorm(100, sd = 0.5)
data <- cbind(X1, X2, X3)

# Bootstrap test
boot_result <- constrained_bootstrap(data, g, B = 100)

}
