% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mi_test.R
\name{mi_test}
\alias{mi_test}
\title{Multilinear Inequality Test for DAG Structures}
\usage{
mi_test(
  data,
  dag,
  test_functions = "squared",
  ordering = "optimal",
  B = 500,
  alpha = 0.05,
  parallel = FALSE,
  verbose = TRUE,
  seed = NULL
)
}
\arguments{
\item{data}{Numeric matrix with n observations and p variables}

\item{dag}{A dag object specifying the DAG structure to test}

\item{test_functions}{Test function(s) to use. Can be:
\itemize{
\item A character string: "squared" (default), "poly", "exp", "indicator"
\item A function
\item A list of functions or specifications
}}

\item{ordering}{Topological ordering to use. Can be:
\itemize{
\item "optimal": Select ordering with maximum Q_n (default)
\item "first": Use first valid ordering
\item "all": Test all orderings with multiple testing correction
\item A character vector specifying a particular ordering
}}

\item{B}{Number of bootstrap replicates (default 500)}

\item{alpha}{Significance level (default 0.05)}

\item{parallel}{Logical or number of cores for parallel processing}

\item{verbose}{Logical; show progress (default TRUE)}

\item{seed}{Random seed for reproducibility}
}
\value{
An S3 object of class "mi_test_result" with components:
\item{statistic}{Observed test statistic T_h^G}
\item{p_value}{Bootstrap p-value}
\item{decision}{Test decision: "reject" or "fail_to_reject"}
\item{alpha}{Significance level used}
\item{qn}{Q_n^G value}
\item{bootstrap}{Bootstrap results (if B > 0)}
\item{ordering}{Topological ordering used}
\item{dag}{The DAG tested}
\item{n_obs}{Number of observations}
\item{n_vars}{Number of variables}
}
\description{
Main interface for the multilinear inequality test based on Carbery's
inequality.

Tests whether observed data is compatible with a specified DAG structure
using Carbery's multilinear inequality.
}
\details{
The test is based on Carbery's multilinear inequality, which states that
for a valid DAG:
\deqn{E\left[\prod_{j=1}^n h_j(X_j) \cdot p_j(X_j)^{1/(n+1)}\right] \leq
      Q_n^G \prod_{j=1}^n \left(E[h_j(X_j)^{n+1}]\right)^{1/(n+1)}}

The test statistic T_h^G = RHS - LHS should be non-negative under H_0.
The null hypothesis is that the data is consistent with the DAG structure.
}
\examples{
# Create and test a chain DAG: X1 -> X2 -> X3
A <- matrix(c(0, 1, 0, 0, 0, 1, 0, 0, 0), 3, 3, byrow = TRUE)
g <- dag(A, nodes = c("X1", "X2", "X3"))

# Generate data consistent with the DAG
set.seed(123)
n <- 200
X1 <- rnorm(n)
X2 <- 0.5 * X1 + rnorm(n, sd = 0.5)
X3 <- 0.5 * X2 + rnorm(n, sd = 0.5)
data <- cbind(X1, X2, X3)

# Test DAG compatibility
result <- mi_test(data, g, B = 100)
print(result)

}
